오늘의 에러 처리 일기 (8.13)
1. 
useQuery로 데이터를 받아올 때
const { data: { data }, isLoading, isError} = useQuery( ... )
형식으로 받아왔었는데 자꾸 에러가 났다.
data가 undefined라고 자꾸 떴었는데 알고보니
로딩 상태일 때는 data가 빈 객체 값이기 때문에
한번 더 data를 비구조화 할당으로 받아오려고 하면 에러가 나는 것이었다.
useQuery를 잘못 쓰고 있는 줄 알고 거기서만 찾고 있었는데
생각지도 못한 곳에 빈틈이 있었다.

data를 이중으로 빼는 비구조화 할당을 data 하나만 빼도록 바꾸고,
로딩 상태를 처리하는 코드를 쿼리 사용 바로 다음 코드에 넣으니 해결되었다.

2. 로컬 테스트 시 페이지를 이동할 때 자꾸 에러메세지가 떴었다.
쿠키가 cross origin 이슈 때문에 로컬에서는 백에서 준 걸 받을 수 없어
reissue가 불가능한데, 그것 때문인 줄 알고 그냥 넘어갔다.
그런데 곰곰히 생각해 보니, 페이지 이동은 라우터만 바뀌는 것이라 reissue할 일이 없었다.
그래서 코드를 찬찬히 뜯어보니 redux 코드에 문제가 있었다.

기존에는 로그인, reissue 시 state.value에 phone과 access 토큰이 들어있는 객체를 할당했다.
문제는 이후 Mypage에서 작성한 코드는 detail 페이지로 넘어갈 때 다른 상태가 들어있는 객체를 할당하게 되어 있었던 것이다.
그래서 로그인/reissue에서 할당한 객체의 phone값이 계속 사라져서 발생한 이슈였다.

redux 코드를
state.value = {
                ...state.value,
                ...token.payload
            } 이런식으로 기존 value값을 유지하면서 새 객체를 추가하는 식으로 바꿔 해결했다.
