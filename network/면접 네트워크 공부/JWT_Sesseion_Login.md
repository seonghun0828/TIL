## JWT와 세션 로그인 방식 비교

### 1. 계기
세션에 비해 JWT로 로그인 기능을 구현하는 것이 여러모로 더 좋다는 얘기를 들어왔다. 이번에 프로젝트를 진행하며 당연히 JWT를 사용하겠거니 생각했다.   
그러나 로그인 방식에 대한 검색을 하며 JWT가 세션보다 로그인 구현에 마냥 더 좋기만 한건 아니라는 글을 보게 되었다.   
거기서 의문이 시작해 두 방식이 어떻게 다르고 어느 상황에서 어떤 걸 써야 하는지 비교해보게 되었다.   
   
### 2. 사용하는 이유
인터넷을 사용하는 인류 대부분이 사용하는 프로토콜인 HTTP는 바로 전 상황도 기억하지 못한다.    
1회성 통신, stateless로 대표되는 특성이 바로 HTTP의 가장 큰 특징이다.   
stateless 하기 때문에 연결을 유지하는데 비용이 적게 들지만 대신 유저를 인증하는 로그인 등에서는 상당히 불편하다.   
그래서 인증을 유지하기 위해 사용하는 것이 바로 세션과 JWT다.   
   
세션과 JWT 방식 모두 클라이언트가 로그인을 요청하면 서버가 확인한다.   
올바른 요청이라고 판단하면 서버는 클라이언트에게 특정 정보를 주게 되고   
이후 그 정보를 통해 유저를 인증할 수 있다. 이때까지는 세션과 JWT 모두 같다.

### 3. 세션
클라이언트가 로그인을 요청하면 서버는 확인된 요청 정보를 서버에 따로 세션으로 저장한다.   
그리고 클라이언트에게 세션 id를 주면 클라이언트는 id를 가지고 있다가 요청 때마다 쿠키에 담아 보낸다.   
서버는 해당 세션 id를 통해 세션 정보를 불러와 로그인이 유효한지 확인한다.   
   
- 장단점   

유저 정보를 서버에 저장하므로 상대적으로 안전하다.   
   
그러나 그 양이 많아지게 되면 서버에 부하가 심해지는 원인이 된다.   
또 여러대의 서버를 사용할 때 각 서버마다 가지고 있는 유저 정보가 다르기 때문에 확장성의 문제가 있다.   
이러한 이유 때문에 트래픽이 많은 서비스에서는 단점을 보완한 세션들이나 JWT를 사용하는 것이 좋을 수 있다.

### 4. JWT
클라이언트가 로그인을 요청할 때 세션 정보를 서버에 저장해두는 세션과 달리 JWT는 서버에 어느것도 저장하지 않는다.    
단지 정보가 암호화된 형태의 토큰을 클라이언트에 건네준다. 클라이언트는 그 토큰을 매 요청 시 같이 보내 유효성 검사를 한다.    
토큰을 보낼 때에는 보통 두 개를 보내는데, 유효기간이 짧은 access token과 유효기간이 긴 refresh token이다.   
access token은 금방 만료되므로 refresh token을 요청 시 보내 매번 access token을 갱신한다.   
   
- 장단점   

서버에 저장하지 않으므로 여유롭게 저장 공간을 사용할 수 있다.    
여러 서버에서도 동작하기 때문에 로드밸런싱 등에 상관 없이 쓸 수 있다.   
   
그러나 JWT는 토큰에 정보를 담고 있기 때문에 용량이 커 전송 시 비용이 커진다.   
또한 클라이언트 단에서 저장할 때 토큰 탈취의 위협에 대응해야 한다.

### 5. 후기

세션과 JWT 로그인 방식에 대해 공부하며 XSS, CSRF 등 사이버 공격에 대해 알게 되었다.   
해킹하는 방법은 많고, 그것을 막기 위한 보안 장치들도 많다. 그를 뚫기 위한 방법도 계속 나올 것이다.   
100% 안전한 방법은 없기에 최대한 빈틈 없이 막을 수 있도록 공부하고 노력해야 할 것이다.   

### 출처
https://team00csduck.tistory.com/93    
https://velog.io/@yaytomato/%ED%94%84%EB%A1%A0%ED%8A%B8%EC%97%90%EC%84%9C-%EC%95%88%EC%A0%84%ED%95%98%EA%B2%8C-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0   
https://fierycoding.tistory.com/69   
https://han-um.tistory.com/17   
https://devjem.tistory.com/13   
